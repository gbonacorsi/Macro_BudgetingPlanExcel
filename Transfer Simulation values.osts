{"version":"0.2.0","body":"// declare worksheet adress\nlet d365fo_sheet_address = \"d365fo\"\nlet simulation_sheet_address = \"sim\"\n\n// declare table connected with the D365FO\nlet d365fo_table_address = \"AxTable1\"\n\n// declare filter value\nlet filter1_name = \"Column2\"\nlet filter1_address = \"B4\"\nlet filter2_name = \"Column3\"\nlet filter2_name_address = \"B5\"\n\n// Mapping forcast variable and columns forcast\nlet forecast_variable1_address= \"B9\"\nlet columns_variable1_name = \"Column5\"\n\nfunction main(workbook: ExcelScript.Workbook) {\n  let d365fo_sheet_sheet = workbook.getWorksheet(d365fo_sheet_address)\n  let simulation_sheet = workbook.getWorksheet(simulation_sheet_address)\n  let d365fo_table = d365fo_sheet_sheet.getTable(d365fo_table_address)\n\n  let filter1_cell = simulation_sheet.getRange(filter1_address)\n  let filter2_cell = simulation_sheet.getRange(filter2_name_address)\n\n  let forecast_variable1_address_cell = simulation_sheet.getRange(forecast_variable1_address)\n  let columns_variable1_index = d365fo_table.getColumnByName(columns_variable1_name).getIndex()\n\n  // filter table\n  d365fo_table.clearFilters()\n  d365fo_table.getColumnByName(filter1_name).getFilter().applyValuesFilter([filter1_cell.getValue().toString()]);\n  d365fo_table.getColumnByName(filter2_name).getFilter().applyValuesFilter([filter2_cell.getValue().toString()]);\n\n  // modify variable value\n  if (d365fo_table.getRangeBetweenHeaderAndTotal().getVisibleView().getRowCount() == 1){\n    let variable_field_address= d365fo_table.getRangeBetweenHeaderAndTotal().getVisibleView().getCellAddresses()[0][columns_variable1_index]\n\n    d365fo_sheet_sheet.getRange(variable_field_address).setValue(forecast_variable1_address_cell.getValue())\n  }\n\n  d365fo_table.clearFilters()\n}\n\n","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}